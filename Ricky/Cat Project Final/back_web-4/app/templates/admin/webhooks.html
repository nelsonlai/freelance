{% extends "admin/_layout.html" %}
{% set title = "Webhook logs" %}
{% set subtitle = "Incoming Make.com payloads" %}

{% block content %}
  <div class="bg-white border rounded-2xl p-5">
    <div class="text-lg font-semibold">Webhook logs</div>
    <div class="text-sm text-slate-600 mt-1">Raw payloads are stored for debugging. Latest first.</div>

    <div class="mt-4 space-y-3">
      {% for w in webhooks %}
        <details class="rounded-2xl border bg-slate-50 p-4">
          <summary class="cursor-pointer flex items-center justify-between">
            <div class="font-medium">#{{ w.id }} â€¢ {{ w.source }}</div>
            <div class="text-xs text-slate-500">{{ w.created_at }}</div>
          </summary>
          <div class="mt-3 grid grid-cols-1 md:grid-cols-2 gap-3">
            <div>
              <div class="text-xs font-medium text-slate-600 mb-1">meta</div>
              <pre class="text-xs bg-white border rounded-xl p-3 overflow-auto">{{ w.meta | tojson(indent=2) }}</pre>
            </div>
            <div>
              <div class="text-xs font-medium text-slate-600 mb-1">payload</div>
              <pre class="text-xs bg-white border rounded-xl p-3 overflow-auto">{{ w.payload | tojson(indent=2) }}</pre>
            </div>
          </div>
        </details>
      {% else %}
        <div class="text-sm text-slate-500">No webhook logs yet.</div>
      {% endfor %}
    </div>
  </div>
{% endblock %}
