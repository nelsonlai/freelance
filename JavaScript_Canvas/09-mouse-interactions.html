<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>09 - Mouse Interactions</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .canvas-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin: 20px 0;
        }
        canvas {
            border: 2px solid #333;
            display: block;
            margin: 20px auto;
            cursor: crosshair;
        }
        .info {
            text-align: center;
            margin: 10px 0;
            color: #666;
        }
        .explanation {
            background: #e8f4f8;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <h1>09 - Mouse Interactions</h1>
    
    <div class="explanation">
        <h2>Responding to Mouse Events</h2>
        <p>Canvas can respond to mouse events like clicks, moves, and drags. You need to calculate mouse coordinates relative to the canvas.</p>
    </div>

    <div class="info" id="mouseInfo">Move your mouse over the canvas</div>

    <div class="canvas-container">
        <canvas id="myCanvas" width="900" height="600"></canvas>
    </div>

    <script>
        const canvas = document.getElementById('myCanvas');
        const ctx = canvas.getContext('2d');
        const mouseInfo = document.getElementById('mouseInfo');
        
        // Mouse state
        let mouse = {
            x: 0,
            y: 0,
            isDown: false,
            lastX: 0,
            lastY: 0
        };
        
        // Drawing state
        let drawing = false;
        let drawColor = '#FF6B6B';
        let brushSize = 10;
        
        // ============================================
        // 1. GET MOUSE POSITION RELATIVE TO CANVAS
        // ============================================
        
        function getMousePos(e) {
            const rect = canvas.getBoundingClientRect();
            return {
                x: e.clientX - rect.left,
                y: e.clientY - rect.top
            };
        }
        
        // ============================================
        // 2. MOUSE MOVE - TRACKING
        // ============================================
        
        let trackingCircle = { x: 100, y: 100 };
        
        canvas.addEventListener('mousemove', (e) => {
            const pos = getMousePos(e);
            mouse.x = pos.x;
            mouse.y = pos.y;
            
            // Update info display
            mouseInfo.textContent = `Mouse: (${Math.floor(mouse.x)}, ${Math.floor(mouse.y)})`;
            
            // Update tracking circle
            trackingCircle.x = mouse.x;
            trackingCircle.y = mouse.y;
            
            // Redraw if drawing
            if (drawing && mouse.isDown) {
                draw();
            }
            
            redraw();
        });
        
        // ============================================
        // 3. MOUSE CLICK - DRAWING
        // ============================================
        
        canvas.addEventListener('mousedown', (e) => {
            const pos = getMousePos(e);
            mouse.isDown = true;
            mouse.lastX = pos.x;
            mouse.lastY = pos.y;
            drawing = true;
            
            // Start drawing
            draw();
        });
        
        canvas.addEventListener('mouseup', () => {
            mouse.isDown = false;
            drawing = false;
        });
        
        canvas.addEventListener('mouseleave', () => {
            mouse.isDown = false;
            drawing = false;
        });
        
        // Drawing function
        function draw() {
            ctx.fillStyle = drawColor;
            ctx.beginPath();
            ctx.arc(mouse.x, mouse.y, brushSize, 0, Math.PI * 2);
            ctx.fill();
            
            // Draw line from last position for smooth drawing
            if (mouse.lastX !== 0 && mouse.lastY !== 0) {
                ctx.strokeStyle = drawColor;
                ctx.lineWidth = brushSize * 2;
                ctx.lineCap = 'round';
                ctx.beginPath();
                ctx.moveTo(mouse.lastX, mouse.lastY);
                ctx.lineTo(mouse.x, mouse.y);
                ctx.stroke();
            }
            
            mouse.lastX = mouse.x;
            mouse.lastY = mouse.y;
        }
        
        // ============================================
        // 4. MOUSE CLICK - OBJECT SELECTION
        // ============================================
        
        // Create some clickable objects
        const objects = [
            { x: 100, y: 100, width: 80, height: 80, color: '#FF6B6B', selected: false },
            { x: 250, y: 150, width: 80, height: 80, color: '#4ECDC4', selected: false },
            { x: 400, y: 120, width: 80, height: 80, color: '#95E1D3', selected: false }
        ];
        
        function isPointInRect(x, y, rect) {
            return x >= rect.x && x <= rect.x + rect.width &&
                   y >= rect.y && y <= rect.y + rect.height;
        }
        
        canvas.addEventListener('click', (e) => {
            const pos = getMousePos(e);
            
            // Check if clicking on an object
            objects.forEach(obj => {
                if (isPointInRect(pos.x, pos.y, obj)) {
                    obj.selected = !obj.selected;
                    redraw();
                }
            });
        });
        
        // ============================================
        // 5. MOUSE DRAG - MOVING OBJECTS
        // ============================================
        
        let draggedObject = null;
        let dragOffset = { x: 0, y: 0 };
        
        canvas.addEventListener('mousedown', (e) => {
            const pos = getMousePos(e);
            
            // Check if clicking on an object to drag
            for (let obj of objects) {
                if (isPointInRect(pos.x, pos.y, obj)) {
                    draggedObject = obj;
                    dragOffset.x = pos.x - obj.x;
                    dragOffset.y = pos.y - obj.y;
                    break;
                }
            }
        });
        
        canvas.addEventListener('mousemove', (e) => {
            if (draggedObject) {
                const pos = getMousePos(e);
                draggedObject.x = pos.x - dragOffset.x;
                draggedObject.y = pos.y - dragOffset.y;
                redraw();
            }
        });
        
        canvas.addEventListener('mouseup', () => {
            draggedObject = null;
        });
        
        // ============================================
        // 6. MOUSE WHEEL - ZOOMING
        // ============================================
        
        let zoom = 1;
        let zoomCenter = { x: canvas.width / 2, y: canvas.height / 2 };
        
        canvas.addEventListener('wheel', (e) => {
            e.preventDefault();
            const pos = getMousePos(e);
            zoomCenter = pos;
            
            const delta = e.deltaY > 0 ? 0.9 : 1.1;
            zoom *= delta;
            zoom = Math.max(0.5, Math.min(3, zoom)); // Limit zoom between 0.5x and 3x
            
            redraw();
        });
        
        // ============================================
        // 7. HOVER EFFECTS
        // ============================================
        
        let hoveredObject = null;
        
        canvas.addEventListener('mousemove', (e) => {
            const pos = getMousePos(e);
            let found = false;
            
            objects.forEach(obj => {
                if (isPointInRect(pos.x, pos.y, obj)) {
                    hoveredObject = obj;
                    found = true;
                    canvas.style.cursor = 'pointer';
                }
            });
            
            if (!found) {
                hoveredObject = null;
                canvas.style.cursor = 'crosshair';
            }
        });
        
        // ============================================
        // DRAWING FUNCTION
        // ============================================
        
        function redraw() {
            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = '#f8f8f8';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Apply zoom (simplified - in real app, you'd use transformations)
            ctx.save();
            ctx.translate(zoomCenter.x, zoomCenter.y);
            ctx.scale(zoom, zoom);
            ctx.translate(-zoomCenter.x, -zoomCenter.y);
            
            // Draw objects
            objects.forEach(obj => {
                // Draw selection outline
                if (obj.selected) {
                    ctx.strokeStyle = '#FFD93D';
                    ctx.lineWidth = 3;
                    ctx.strokeRect(obj.x - 5, obj.y - 5, obj.width + 10, obj.height + 10);
                }
                
                // Draw hover effect
                if (obj === hoveredObject) {
                    ctx.shadowColor = 'rgba(0, 0, 0, 0.3)';
                    ctx.shadowBlur = 10;
                }
                
                // Draw object
                ctx.fillStyle = obj.color;
                ctx.fillRect(obj.x, obj.y, obj.width, obj.height);
                
                // Reset shadow
                ctx.shadowColor = 'transparent';
                ctx.shadowBlur = 0;
            });
            
            ctx.restore();
            
            // Draw tracking circle
            ctx.fillStyle = 'rgba(108, 92, 231, 0.5)';
            ctx.beginPath();
            ctx.arc(trackingCircle.x, trackingCircle.y, 20, 0, Math.PI * 2);
            ctx.fill();
            
            // Draw instructions
            ctx.fillStyle = '#333';
            ctx.font = '14px Arial';
            ctx.fillText('Click and drag to draw | Click objects to select | Drag objects to move | Scroll to zoom', 10, 20);
        }
        
        // Initial draw
        redraw();
        
        // Change brush color on right click
        canvas.addEventListener('contextmenu', (e) => {
            e.preventDefault();
            const colors = ['#FF6B6B', '#4ECDC4', '#95E1D3', '#F38181', '#6C5CE7', '#FFD93D'];
            drawColor = colors[Math.floor(Math.random() * colors.length)];
        });
    </script>
</body>
</html>

