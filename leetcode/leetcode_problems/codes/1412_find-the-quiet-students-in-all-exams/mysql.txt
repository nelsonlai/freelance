# Write your MySQL query statement below
WITH ExamStats AS (
    SELECT 
        student_id,
        exam_id,
        score,
        MIN(score) OVER (PARTITION BY exam_id) AS min_score,
        MAX(score) OVER (PARTITION BY exam_id) AS max_score
    FROM Exam
)
SELECT DISTINCT s.student_id, s.student_name
FROM Student s
JOIN ExamStats e ON s.student_id = e.student_id
WHERE s.student_id NOT IN (
    SELECT DISTINCT student_id
    FROM ExamStats
    WHERE score = min_score OR score = max_score
)
ORDER BY s.student_id;
