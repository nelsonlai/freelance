# Write your MySQL query statement below
WITH FailedDates AS (
    SELECT fail_date AS date, 'failed' AS period_state
    FROM Failed
    WHERE fail_date BETWEEN '2019-01-01' AND '2019-12-31'
),
SucceededDates AS (
    SELECT success_date AS date, 'succeeded' AS period_state
    FROM Succeeded
    WHERE success_date BETWEEN '2019-01-01' AND '2019-12-31'
),
AllDates AS (
    SELECT * FROM FailedDates
    UNION ALL
    SELECT * FROM SucceededDates
),
GroupedDates AS (
    SELECT 
        date,
        period_state,
        ROW_NUMBER() OVER (PARTITION BY period_state ORDER BY date) AS rn,
        DATE_SUB(date, INTERVAL ROW_NUMBER() OVER (PARTITION BY period_state ORDER BY date) DAY) AS group_id
    FROM AllDates
)
SELECT 
    period_state,
    MIN(date) AS start_date,
    MAX(date) AS end_date
FROM GroupedDates
GROUP BY period_state, group_id
ORDER BY start_date;
