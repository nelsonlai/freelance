# Write your MySQL query statement below
WITH RECURSIVE Numbers AS (
    SELECT 0 AS transactions_count
    UNION ALL
    SELECT transactions_count + 1
    FROM Numbers
    WHERE transactions_count < (
        SELECT MAX(transaction_count) 
        FROM (
            SELECT COUNT(*) AS transaction_count
            FROM Visits v
            LEFT JOIN Transactions t ON v.user_id = t.user_id AND v.visit_date = t.transaction_date
            GROUP BY v.user_id, v.visit_date
        ) AS counts
    )
),
VisitCounts AS (
    SELECT 
        COUNT(*) AS transactions_count,
        COUNT(*) AS visits_count
    FROM Visits v
    LEFT JOIN Transactions t ON v.user_id = t.user_id AND v.visit_date = t.transaction_date
    GROUP BY v.user_id, v.visit_date
)
SELECT 
    n.transactions_count,
    COALESCE(SUM(vc.visits_count), 0) AS visits_count
FROM Numbers n
LEFT JOIN VisitCounts vc ON n.transactions_count = vc.transactions_count
GROUP BY n.transactions_count
ORDER BY n.transactions_count;
